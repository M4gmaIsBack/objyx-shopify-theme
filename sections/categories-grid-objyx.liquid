{{ 'section-categories-grid-objyx.css' | asset_url | stylesheet_tag }}

{%- assign heading_text = section.settings.heading -%}
{%- assign kicker_text = section.settings.kicker -%}

<section
  class="categories-grid-objyx section-categories-grid"
  data-desktop-columns="{{ section.settings.columns_desktop }}"
  data-mobile-columns="{{ section.settings.columns_mobile }}"
>
  <div class="categories-grid-objyx__container">
    {%- if heading_text != blank or kicker_text != blank or section.settings.subheading != blank -%}
      <div class="categories-grid-objyx__title">
        {%- if kicker_text != blank -%}
          <span class="categories-grid-objyx__kicker">{{ kicker_text }}</span>
        {%- endif -%}
        {%- if heading_text != blank -%}
          <h2 class="categories-grid-objyx__heading">{{ heading_text }}</h2>
        {%- endif -%}
        {%- if section.settings.subheading != blank -%}
          <p class="categories-grid-objyx__subheading">{{ section.settings.subheading }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}

    <div class="categories-grid-objyx__grid">
      {%- for collection in collections -%}
        {%- unless collection.handle == 'all'
          or collection.handle == 'frontpage'
          or collection.handle == 'nouveautes'
          or collection.featured_image == blank
        -%}
          {%- if collection.featured_image and collection.featured_image.src -%}
            <a href="{{ collection.url }}" class="categories-grid-objyx__card">
              <div class="categories-grid-objyx__media">
                <img
                  src="{{ collection.featured_image | image_url: width: 600 }}"
                  srcset="
                    {{ collection.featured_image | image_url: width: 300 }} 300w,
                    {{ collection.featured_image | image_url: width: 600 }} 600w,
                    {{ collection.featured_image | image_url: width: 900 }} 900w
                  "
                  sizes="(min-width: 990px) 25vw, (min-width: 750px) 33vw, 50vw"
                  alt="{{ collection.title | escape }}"
                  loading="lazy"
                  class="categories-grid-objyx__image"
                >
                <div class="categories-grid-objyx__label">
                  <span class="categories-grid-objyx__label-title">{{ collection.title }}</span>
                  {%- if section.settings.show_product_count -%}
                    <span class="categories-grid-objyx__label-count">{{ collection.products_count }} produits</span>
                  {%- endif -%}
                </div>
              </div>
              <div class="categories-grid-objyx__cta">
                <span>Decouvrir</span>
                <span class="categories-grid-objyx__cta-icon" aria-hidden="true">?</span>
              </div>
            </a>
          {%- endif -%}
        {%- endunless -%}
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Categories Grille",
  "tag": "section",
  "class": "section-categories-grid",
  "settings": [
    {
      "type": "text",
      "id": "kicker",
      "label": "Sur-titre (petit label)"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Titre de la section"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Sous-titre"
    },
    {
      "type": "checkbox",
      "id": "show_product_count",
      "label": "Afficher le nombre de produits",
      "default": true
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 5,
      "step": 1,
      "default": 4,
      "label": "Colonnes sur desktop"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "options": [
        {
          "value": "1",
          "label": "1 colonne"
        },
        {
          "value": "2",
          "label": "2 colonnes"
        }
      ],
      "default": "2",
      "label": "Colonnes sur mobile"
    }
  ],
  "presets": [
    {
      "name": "Categories Grille"
    }
  ]
}
{% endschema %}
